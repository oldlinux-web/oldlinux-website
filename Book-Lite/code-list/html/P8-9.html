<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name=Generator content="Microsoft Word 14 (filtered)">

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:����;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:����;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:����;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:����С���μ���;}
@font-face
	{font-family:"\@����";
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@����";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@����С���μ���";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
h1
	{mso-style-link:"���� 1 Char";
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:7.2pt;
	text-align:center;
	text-indent:-7.2pt;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
h2
	{mso-style-link:"���� 2 Char";
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
h3
	{mso-style-link:"���� 3 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
h4
	{mso-style-link:"���� 4 Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:28.8pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-28.8pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
h5
	{mso-style-link:"���� 5 Char";
	margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:36.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-36.0pt;
	line-height:156%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:����;
	font-weight:bold;}
h6
	{mso-style-link:"���� 6 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:43.2pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-43.2pt;
	line-height:133%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"���� 7 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:50.4pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-50.4pt;
	line-height:133%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:����;
	font-weight:bold;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-link:"���� 8 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:57.6pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-72.0pt;
	line-height:133%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-link:"���� 9 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:64.8pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-79.2pt;
	line-height:133%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.MsoIndex1, li.MsoIndex1, div.MsoIndex1
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:10.5pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-10.5pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoIndex2, li.MsoIndex2, div.MsoIndex2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-10.5pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoIndex3, li.MsoIndex3, div.MsoIndex3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:31.5pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-10.5pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoIndex4, li.MsoIndex4, div.MsoIndex4
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-10.5pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoIndex5, li.MsoIndex5, div.MsoIndex5
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:52.5pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-10.5pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoIndex6, li.MsoIndex6, div.MsoIndex6
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:63.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-10.5pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoIndex7, li.MsoIndex7, div.MsoIndex7
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:73.5pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-10.5pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoIndex8, li.MsoIndex8, div.MsoIndex8
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-10.5pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoIndex9, li.MsoIndex9, div.MsoIndex9
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:94.5pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-10.5pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:31.5pt;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:����;}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.0pt;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:����;}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:52.5pt;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:����;}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:63.0pt;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:����;}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:73.5pt;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:����;}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:����;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{mso-style-link:"��ע�ı� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:����;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"��ע���� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"ҳü Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	layout-grid-mode:char;
	border:none;
	padding:0cm;
	font-size:9.0pt;
	font-family:����;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"ҳ�� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:����;}
p.MsoIndexHeading, li.MsoIndexHeading, div.MsoIndexHeading
	{mso-style-name:"��������\,������Ŀ\,������Ŀ1\,������Ŀ2";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.MsoTof, li.MsoTof, div.MsoTof
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-21.0pt;
	font-size:10.5pt;
	font-family:����;}
span.MsoFootnoteReference
	{vertical-align:super;}
p.MsoList, li.MsoList, div.MsoList
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.0pt;
	font-size:10.5pt;
	font-family:����;}
p.MsoList2, li.MsoList2, div.MsoList2
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.MsoList4, li.MsoList4, div.MsoList4
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.MsoDate, li.MsoDate, div.MsoDate
	{mso-style-link:"���� Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:5.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
a:link, span.MsoHyperlink
	{mso-style-name:"������\,��������";
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{mso-style-name:"��ͨ\(��վ\)\,��ͨ \(Web\)\,��ͨ \(Web\)1\,��ͨ \(Web\)2\,��ͨ \(Web\)3";
	margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:����;}
pre
	{mso-style-name:"HTML Ԥ���ʽ\,HTML Ԥ�ȸ�ʽ��\,HTML Ԥ�ȸ�ʽ��1\,HTML Ԥ�ȸ�ʽ��2\,HTML Ԥ�ȸ�ʽ��3";
	mso-style-link:"HTML Ԥ���ʽ Char\,HTML Ԥ�ȸ�ʽ�� Char\,HTML Ԥ�ȸ�ʽ��1 Char\,HTML Ԥ�ȸ�ʽ��2 Char\,HTML Ԥ�ȸ�ʽ��3 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:����;}
tt
	{font-family:����;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-link:"��ע���� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:����;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"��ע���ı� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:9.0pt;
	font-family:����;}
p.1, li.1, div.1
	{mso-style-name:��ʽ1;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.0pt;
	font-size:10.5pt;
	font-family:����;}
p.a, li.a, div.a
	{mso-style-name:�������;
	mso-style-link:"������� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:����;}
span.Char
	{mso-style-name:"������� Char";
	mso-style-link:�������;
	font-family:����;}
p.a0, li.a0, div.a0
	{mso-style-name:ͼ˵��;
	mso-style-link:"ͼ˵�� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
span.Char0
	{mso-style-name:"ͼ˵�� Char";
	mso-style-link:ͼ˵��;
	font-family:����;}
p.0, li.0, div.0
	{mso-style-name:����0;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:36.0pt;
	font-family:����;
	font-weight:bold;}
p.10, li.10, div.10
	{mso-style-name:����1;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:18.0pt;
	font-family:����;
	font-weight:bold;}
p.11, li.11, div.11
	{mso-style-name:�Ǳ���1;
	margin-top:7.8pt;
	margin-right:0cm;
	margin-bottom:7.8pt;
	margin-left:0cm;
	text-align:center;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.a1, li.a1, div.a1
	{mso-style-name:�ı�����;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.3CharChar, li.3CharChar, div.3CharChar
	{mso-style-name:"ͼ������3 Char Char";
	mso-style-link:"ͼ������3 Char Char Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:9.0pt;
	font-size:8.0pt;
	font-family:����;}
span.3CharCharChar
	{mso-style-name:"ͼ������3 Char Char Char";
	mso-style-link:"ͼ������3 Char Char";
	font-family:����;}
p.post, li.post, div.post
	{mso-style-name:�ʼ�post;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:11.0pt;
	font-size:10.5pt;
	font-family:����;}
p.3, li.3, div.3
	{mso-style-name:ͼ������3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.3CharChar1CharCharChar
	{mso-style-name:"ͼ������3 Char Char1 Char Char Char";
	font-family:����;}
span.3CharChar1CharChar
	{mso-style-name:"ͼ������3 Char Char1 Char Char";
	font-family:����;}
p.5Char, li.5Char, div.5Char
	{mso-style-name:"ͼ������5�� Char";
	mso-style-link:"ͼ������5�� Char Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
span.5CharChar
	{mso-style-name:"ͼ������5�� Char Char";
	mso-style-link:"ͼ������5�� Char";
	font-family:����;}
p.5CharChar0, li.5CharChar0, div.5CharChar0
	{mso-style-name:"ͼ������С5�� Char Char";
	mso-style-link:"ͼ������С5�� Char Char Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
span.5CharCharChar
	{mso-style-name:"ͼ������С5�� Char Char Char";
	mso-style-link:"ͼ������С5�� Char Char";
	font-family:����;}
p.5Char0, li.5Char0, div.5Char0
	{mso-style-name:"ͼ������С5�� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
p.5, li.5, div.5
	{mso-style-name:ͼ������С5��;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:����;}
p.2, li.2, div.2
	{mso-style-name:�������2;
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:����;}
p.20, li.20, div.20
	{mso-style-name:ͼ˵��2;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.21, li.21, div.21
	{mso-style-name:�ı�����2;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.3CharCharCharCharChar, li.3CharCharCharCharChar, div.3CharCharCharCharChar
	{mso-style-name:"ͼ������3 Char Char Char Char Char";
	mso-style-link:"ͼ������3 Char Char Char Char Char Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:9.0pt;
	font-size:8.0pt;
	font-family:����;}
span.3CharCharCharCharCharChar
	{mso-style-name:"ͼ������3 Char Char Char Char Char Char";
	mso-style-link:"ͼ������3 Char Char Char Char Char";
	font-family:����;}
p.a2, li.a2, div.a2
	{mso-style-name:ͼ����;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.110, li.110, div.110
	{mso-style-name:"��ʽ ���� 1 + ����1";
	margin-right:0cm;
	margin-left:0cm;
	text-align:center;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
span.1Char
	{mso-style-name:"���� 1 Char";
	mso-style-link:"���� 1";
	font-weight:bold;}
p.22, li.22, div.22
	{mso-style-name:"��ʽ �б� 2 + ����";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.23, li.23, div.23
	{mso-style-name:�б�2;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.50, li.50, div.50
	{mso-style-name:ͼ������5��;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.111, li.111, div.111
	{mso-style-name:��ʽ11;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.0pt;
	font-size:10.5pt;
	font-family:����;}
p.12, li.12, div.12
	{mso-style-name:�������1;
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:����;}
p.13, li.13, div.13
	{mso-style-name:ͼ˵��1;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.01, li.01, div.01
	{mso-style-name:����01;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:36.0pt;
	font-family:����;
	font-weight:bold;}
p.112, li.112, div.112
	{mso-style-name:����11;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:18.0pt;
	font-family:����;
	font-weight:bold;}
p.113, li.113, div.113
	{mso-style-name:�Ǳ���11;
	margin-top:7.8pt;
	margin-right:0cm;
	margin-bottom:7.8pt;
	margin-left:0cm;
	text-align:center;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.14, li.14, div.14
	{mso-style-name:�ı�����1;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.3Char1, li.3Char1, div.3Char1
	{mso-style-name:"ͼ������3 Char1";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:9.0pt;
	font-size:8.0pt;
	font-family:����;}
p.post1, li.post1, div.post1
	{mso-style-name:�ʼ�post1;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:11.0pt;
	font-size:10.5pt;
	font-family:����;}
p.31, li.31, div.31
	{mso-style-name:ͼ������31;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.5Char1, li.5Char1, div.5Char1
	{mso-style-name:"ͼ������5�� Char1";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.5CharChar1, li.5CharChar1, div.5CharChar1
	{mso-style-name:"ͼ������С5�� Char Char1";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
p.5Char10, li.5Char10, div.5Char10
	{mso-style-name:"ͼ������С5�� Char1";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
p.51, li.51, div.51
	{mso-style-name:ͼ������С5��1;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
p.120, li.120, div.120
	{mso-style-name:��ʽ12;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.0pt;
	font-size:10.5pt;
	font-family:����;}
p.02, li.02, div.02
	{mso-style-name:����02;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:36.0pt;
	font-family:����;
	font-weight:bold;}
p.121, li.121, div.121
	{mso-style-name:����12;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:18.0pt;
	font-family:����;
	font-weight:bold;}
p.122, li.122, div.122
	{mso-style-name:�Ǳ���12;
	margin-top:7.8pt;
	margin-right:0cm;
	margin-bottom:7.8pt;
	margin-left:0cm;
	text-align:center;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.3Char2, li.3Char2, div.3Char2
	{mso-style-name:"ͼ������3 Char2";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:9.0pt;
	font-size:8.0pt;
	font-family:����;}
p.post2, li.post2, div.post2
	{mso-style-name:�ʼ�post2;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:11.0pt;
	font-size:10.5pt;
	font-family:����;}
p.32, li.32, div.32
	{mso-style-name:ͼ������32;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.5Char2, li.5Char2, div.5Char2
	{mso-style-name:"ͼ������С5�� Char2";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
p.52, li.52, div.52
	{mso-style-name:ͼ������С5��2;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
p.3CharCharCharChar, li.3CharCharCharChar, div.3CharCharCharChar
	{mso-style-name:"ͼ������3 Char Char Char Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:9.0pt;
	font-size:8.0pt;
	font-family:����;}
p.130, li.130, div.130
	{mso-style-name:��ʽ13;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.0pt;
	font-size:10.5pt;
	font-family:����;}
p.30, li.30, div.30
	{mso-style-name:�������3;
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:����;}
p.03, li.03, div.03
	{mso-style-name:����03;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:36.0pt;
	font-family:����;
	font-weight:bold;}
p.131, li.131, div.131
	{mso-style-name:����13;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:18.0pt;
	font-family:����;
	font-weight:bold;}
p.132, li.132, div.132
	{mso-style-name:�Ǳ���13;
	margin-top:7.8pt;
	margin-right:0cm;
	margin-bottom:7.8pt;
	margin-left:0cm;
	text-align:center;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.33, li.33, div.33
	{mso-style-name:�ı�����3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.3Char3, li.3Char3, div.3Char3
	{mso-style-name:"ͼ������3 Char3";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:9.0pt;
	font-size:8.0pt;
	font-family:����;}
p.post3, li.post3, div.post3
	{mso-style-name:�ʼ�post3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:11.0pt;
	font-size:10.5pt;
	font-family:����;}
p.330, li.330, div.330
	{mso-style-name:ͼ������33;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.5Char20, li.5Char20, div.5Char20
	{mso-style-name:"ͼ������5�� Char2";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.5CharChar2, li.5CharChar2, div.5CharChar2
	{mso-style-name:"ͼ������С5�� Char Char2";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
p.5Char3, li.5Char3, div.5Char3
	{mso-style-name:"ͼ������С5�� Char3";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
p.53, li.53, div.53
	{mso-style-name:ͼ������С5��3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:9.0pt;
	font-family:����;}
p.3Char, li.3Char, div.3Char
	{mso-style-name:"ͼ������3 Char";
	mso-style-link:"ͼ������3 Char Char5";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:9.0pt;
	font-size:8.0pt;
	font-family:����;}
span.3CharChar5
	{mso-style-name:"ͼ������3 Char Char5";
	mso-style-link:"ͼ������3 Char";
	font-family:����;}
p.54, li.54, div.54
	{mso-style-name:ͼ������С5����;
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:9.0pt;
	text-autospace:ideograph-numeric;
	font-size:9.0pt;
	font-family:����;}
p.24, li.24, div.24
	{mso-style-name:����2�Ŵ�����;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.15, li.15, div.15
	{mso-style-name:"��ʽ ���� 1 + ����";
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	text-align:center;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.25, li.25, div.25
	{mso-style-name:"��ʽ ���� 2 + �о�\: �����о�";
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:28.9pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-28.9pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
span.2Char
	{mso-style-name:"���� 2 Char";
	mso-style-link:"���� 2";
	font-family:"Arial","sans-serif";
	font-weight:bold;}
p.34, li.34, div.34
	{mso-style-name:�б�3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.35, li.35, div.35
	{mso-style-name:��3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.4, li.4, div.4
	{mso-style-name:ͼ˵��4;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.40, li.40, div.40
	{mso-style-name:�б�4;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.0pt;
	font-size:10.5pt;
	font-family:����;}
p.41, li.41, div.41
	{mso-style-name:��4;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.55, li.55, div.55
	{mso-style-name:ͼ˵��5;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.56, li.56, div.56
	{mso-style-name:�б�5;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.57, li.57, div.57
	{mso-style-name:��5;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.6, li.6, div.6
	{mso-style-name:�б�6;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.60, li.60, div.60
	{mso-style-name:��6;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.61, li.61, div.61
	{mso-style-name:ͼ˵��6;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.7, li.7, div.7
	{mso-style-name:�б�7;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.70, li.70, div.70
	{mso-style-name:ͼ˵��7;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.71, li.71, div.71
	{mso-style-name:��7;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.8, li.8, div.8
	{mso-style-name:�б�8;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.9, li.9, div.9
	{mso-style-name:�б�9;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.90, li.90, div.90
	{mso-style-name:ͼ˵��9;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.100, li.100, div.100
	{mso-style-name:�б�10;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.101, li.101, div.101
	{mso-style-name:ͼ˵��10;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.114, li.114, div.114
	{mso-style-name:�б�11;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.115, li.115, div.115
	{mso-style-name:ͼ˵��11;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.116, li.116, div.116
	{mso-style-name:��11;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.123, li.123, div.123
	{mso-style-name:�б�12;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.124, li.124, div.124
	{mso-style-name:ͼ˵��12;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.133, li.133, div.133
	{mso-style-name:ͼ˵��13;
	mso-style-link:"ͼ˵��13 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
span.13Char
	{mso-style-name:"ͼ˵��13 Char";
	mso-style-link:ͼ˵��13;
	font-family:����;}
p.134, li.134, div.134
	{mso-style-name:�б�13;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.26, li.26, div.26
	{mso-style-name:��¼2;
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
p.36, li.36, div.36
	{mso-style-name:��¼3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
span.3Char0
	{mso-style-name:"���� 3 Char";
	mso-style-link:"���� 3";
	font-family:"Arial","sans-serif";
	font-weight:bold;}
p.16, li.16, div.16
	{mso-style-name:��¼1;
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	text-align:center;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.17, li.17, div.17
	{mso-style-name:��¼��1;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.42, li.42, div.42
	{mso-style-name:��¼4;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
span.4Char
	{mso-style-name:"���� 4 Char";
	mso-style-link:"���� 4";
	font-family:"Arial","sans-serif";
	font-weight:bold;}
p.a3, li.a3, div.a3
	{mso-style-name:��¼ͼ˵��;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.27, li.27, div.27
	{mso-style-name:�����2;
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:28.8pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-28.8pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
p.a4, li.a4, div.a4
	{mso-style-name:�ο�����;
	margin-top:7.8pt;
	margin-right:0cm;
	margin-bottom:7.8pt;
	margin-left:0cm;
	text-align:center;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.18, li.18, div.18
	{mso-style-name:��������1;
	margin-top:7.8pt;
	margin-right:0cm;
	margin-bottom:7.8pt;
	margin-left:0cm;
	text-align:center;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.19, li.19, div.19
	{mso-style-name:�б�1;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.25pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.25pt;
	font-size:10.5pt;
	font-family:����;}
p.1a, li.1a, div.1a
	{mso-style-name:��1;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.25pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.25pt;
	font-size:10.5pt;
	font-family:����;}
p.37, li.37, div.37
	{mso-style-name:ͼ˵��3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.62, li.62, div.62
	{mso-style-name:��������6��;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	layout-grid-mode:char;
	font-size:7.5pt;
	font-family:����;}
p.a5, li.a5, div.a5
	{mso-style-name:���Ĵ���;
	mso-style-link:"���Ĵ��� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.Char1
	{mso-style-name:"���Ĵ��� Char";
	mso-style-link:���Ĵ���;
	font-family:����;}
p.43, li.43, div.43
	{mso-style-name:"��ʽ ���� 4 +";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
p.140, li.140, div.140
	{mso-style-name:��14;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.25pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.25pt;
	font-size:10.5pt;
	font-family:����;}
p.141, li.141, div.141
	{mso-style-name:ͼ˵��14;
	mso-style-link:"ͼ˵��14 Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.25pt;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-21.25pt;
	font-size:10.5pt;
	font-family:����;}
span.14Char
	{mso-style-name:"ͼ˵��14 Char";
	mso-style-link:ͼ˵��14;
	font-family:����;}
p.a6, li.a6, div.a6
	{mso-style-name:�ļ�Ŀ¼��;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.a7, li.a7, div.a7
	{mso-style-name:"��ʽ ���� +";
	mso-style-link:"��ʽ ���� + Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.Char2
	{mso-style-name:"��ʽ ���� + Char";
	mso-style-link:"��ʽ ���� +";
	font-family:"Times New Roman","serif";}
p.a8, li.a8, div.a8
	{mso-style-name:������ע;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.a9, li.a9, div.a9
	{mso-style-name:�б���ע;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.aa, li.aa, div.aa
	{mso-style-name:ͼ��ע;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.ab, li.ab, div.ab
	{mso-style-name:������ע;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.ac, li.ac, div.ac
	{mso-style-name:��������;
	margin-top:0cm;
	margin-right:21.0pt;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	border:none;
	padding:0cm;
	font-size:9.0pt;
	font-family:����;}
p.125, li.125, div.125
	{mso-style-name:"��ʽ ���� 1 + ����2";
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	text-align:center;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:����;
	font-weight:bold;}
p.ad, li.ad, div.ad
	{mso-style-name:"��ʽ ��ע + ���� ��� ����";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.1b, li.1b, div.1b
	{mso-style-name:�����1;
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	line-height:240%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:����;
	font-weight:bold;}
p.38, li.38, div.38
	{mso-style-name:�����3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:����С���μ���;}
p.63, li.63, div.63
	{mso-style-name:��������6��;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:7.5pt;
	font-family:����;}
p.64, li.64, div.64
	{mso-style-name:ͼ������6�������;
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:10.0pt;
	layout-grid-mode:char;
	font-size:7.5pt;
	font-family:����;}
p.65, li.65, div.65
	{mso-style-name:ͼ������6��;
	mso-style-link:"ͼ������6�� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:10.0pt;
	layout-grid-mode:char;
	font-size:7.5pt;
	font-family:����;}
span.6Char
	{mso-style-name:"ͼ������6�� Char";
	mso-style-link:ͼ������6��;
	font-family:����;}
p.ae, li.ae, div.ae
	{mso-style-name:ͼ��;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.28, li.28, div.28
	{mso-style-name:ͼ��2;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
p.af, li.af, div.af
	{mso-style-name:ϰ�����;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:����;}
p.1c, li.1c, div.1c
	{mso-style-name:���ֱ��1;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:16.0pt;
	font-family:����;}
p.af0, li.af0, div.af0
	{mso-style-name:������;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.af1, li.af1, div.af1
	{mso-style-name:"��ʽ ��ע + ����";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:����;}
p.ListTitle, li.ListTitle, div.ListTitle
	{mso-style-name:ListTitle;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.FigureTitle, li.FigureTitle, div.FigureTitle
	{mso-style-name:FigureTitle;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.TableTitle, li.TableTitle, div.TableTitle
	{mso-style-name:TableTitle;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.ProgramTitle, li.ProgramTitle, div.ProgramTitle
	{mso-style-name:ProgramTitle;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.5pt;
	font-family:"Arial","sans-serif";}
p.RightText, li.RightText, div.RightText
	{mso-style-name:RightText;
	margin-top:0cm;
	margin-right:21.0pt;
	margin-bottom:0cm;
	margin-left:42.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	border:none;
	padding:0cm;
	font-size:9.0pt;
	font-family:����;}
p.af2, li.af2, div.af2
	{mso-style-name:��������С��;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:9.0pt;
	font-family:����;}
p.af3, li.af3, div.af3
	{mso-style-name:�ؼ���;
	mso-style-link:"�ؼ��� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.Char3
	{mso-style-name:"�ؼ��� Char";
	mso-style-link:�ؼ���;
	font-family:����;}
p.af4, li.af4, div.af4
	{mso-style-name:�ļ���;
	mso-style-link:"�ļ��� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.Char4
	{mso-style-name:"�ļ��� Char";
	mso-style-link:�ļ���;
	font-family:����;}
p.af5, li.af5, div.af5
	{mso-style-name:ѡ��;
	mso-style-link:"ѡ�� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.Char5
	{mso-style-name:"ѡ�� Char";
	mso-style-link:ѡ��;
	font-family:����;}
p.af6, li.af6, div.af6
	{mso-style-name:������;
	mso-style-link:"������ Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.Char6
	{mso-style-name:"������ Char";
	mso-style-link:������;
	font-family:����;}
p.af7, li.af7, div.af7
	{mso-style-name:������;
	mso-style-link:"������ Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.Char7
	{mso-style-name:"������ Char";
	mso-style-link:������;
	font-family:����;}
p.af8, li.af8, div.af8
	{mso-style-name:�Ĵ�����;
	mso-style-link:"�Ĵ����� Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.Char8
	{mso-style-name:"�Ĵ����� Char";
	mso-style-link:�Ĵ�����;
	font-family:"Times New Roman","serif";}
p.af9, li.af9, div.af9
	{mso-style-name:������;
	mso-style-link:"������ Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:����;}
span.Char9
	{mso-style-name:"������ Char";
	mso-style-link:������;
	font-family:����;}
p.58, li.58, div.58
	{mso-style-name:ͼ������С5����;
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:����;}
p.59, li.59, div.59
	{mso-style-name:ͼ������С5�ſ���;
	margin:0cm;
	margin-bottom:.0001pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:����;}
p.926, li.926, div.926
	{mso-style-name:"��ʽ ������� + ���\:  9\.26 ����";
	margin:0cm;
	margin-bottom:.0001pt;
	layout-grid-mode:char;
	font-size:10.0pt;
	font-family:����;}
span.5Char4
	{mso-style-name:"���� 5 Char";
	mso-style-link:"���� 5";
	font-weight:bold;}
span.6Char0
	{mso-style-name:"���� 6 Char";
	mso-style-link:"���� 6";
	font-family:"Arial","sans-serif";
	font-weight:bold;}
span.7Char
	{mso-style-name:"���� 7 Char";
	mso-style-link:"���� 7";
	font-weight:bold;}
span.8Char
	{mso-style-name:"���� 8 Char";
	mso-style-link:"���� 8";
	font-family:"Arial","sans-serif";}
span.9Char
	{mso-style-name:"���� 9 Char";
	mso-style-link:"���� 9";
	font-family:"Arial","sans-serif";}
span.Chara
	{mso-style-name:"��ע�ı� Char";
	mso-style-link:��ע�ı�;
	font-family:����;}
span.Charb
	{mso-style-name:"��ע���� Char";
	mso-style-link:��ע����;
	font-family:����;}
span.Charc
	{mso-style-name:"ҳü Char";
	mso-style-link:ҳü;
	font-family:����;}
span.Chard
	{mso-style-name:"ҳ�� Char";
	mso-style-link:ҳ��;
	font-family:����;}
span.Chare
	{mso-style-name:"���� Char";
	mso-style-link:����;
	font-family:����;}
span.HTMLChar
	{mso-style-name:"HTML Ԥ���ʽ Char\,HTML Ԥ�ȸ�ʽ�� Char\,HTML Ԥ�ȸ�ʽ��1 Char\,HTML Ԥ�ȸ�ʽ��2 Char\,HTML Ԥ�ȸ�ʽ��3 Char";
	mso-style-link:"HTML Ԥ���ʽ\,HTML Ԥ�ȸ�ʽ��\,HTML Ԥ�ȸ�ʽ��1\,HTML Ԥ�ȸ�ʽ��2\,HTML Ԥ�ȸ�ʽ��3";
	font-family:����;}
span.Charf
	{mso-style-name:"��ע���� Char";
	mso-style-link:��ע����;
	font-family:����;
	font-weight:bold;}
span.Charf0
	{mso-style-name:"��ע���ı� Char";
	mso-style-link:��ע���ı�;
	font-family:����;}
span.3CharChar1
	{mso-style-name:"ͼ������3 Char Char1";
	font-family:����;}
span.5CharCharChar0
	{mso-style-name:"ͼ������5�� Char Char Char";
	font-family:����;}
span.3CharChar3
	{mso-style-name:"ͼ������3 Char Char3";
	font-family:����;}
span.3CharChar1Char
	{mso-style-name:"ͼ������3 Char Char1 Char";
	font-family:����;}
span.3CharChar13
	{mso-style-name:"ͼ������3 Char Char13";
	font-family:����;}
span.3CharChar12
	{mso-style-name:"ͼ������3 Char Char12";
	font-family:����;}
span.3CharChar11
	{mso-style-name:"ͼ������3 Char Char11";
	font-family:����;}
.MsoChpDefault
	{font-size:10.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 54.0pt 72.0pt 54.0pt;
	layout-grid:15.6pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN link=blue vlink=purple style='text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<p class=ab><a name="_Toc53320611"><span style='font-family:����'>����</span><span
lang=EN-US>8-9 linux/kernel/sys.c</span></a><span style='font-family:����'>����</span></p>

<div class=a align=center style='text-align:center'><span lang=EN-US>

<hr size=4 width="100%" align=center>

</span></div>

<p class=a><span lang=EN-US>&nbsp; <u><span style='color:blue'>1</span></u> <b><i>/*</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp; <u><span style='color:blue'>2</span></u> <b><i>&nbsp;*&nbsp;
linux/kernel/sys.c</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp; <u><span style='color:blue'>3</span></u> <b><i>&nbsp;*</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp; <u><span style='color:blue'>4</span></u> <b><i>&nbsp;*&nbsp;
(C) 1991&nbsp; Linus Torvalds</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp; <u><span style='color:blue'>5</span></u> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp; <u><span style='color:blue'>6</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp; <u><span style='color:blue'>7</span></u>
#include &lt;errno.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;// </span>�����ͷ�ļ�������ϵͳ�и��ֳ����š�</p>

<p class=a><span lang=EN-US>&nbsp; <u><span style='color:blue'>8</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp; <u><span style='color:blue'>9</span></u>
#include &lt;linux/sched.h&gt;&nbsp; // </span>���ȳ���ͷ�ļ�������������ṹ<span lang=EN-US>task_struct</span>������<span
lang=EN-US>0</span>�����ݣ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// </span>����һЩ�й��������������úͻ�ȡ��Ƕ��ʽ��ຯ������䡣</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>10</span></u>
#include &lt;linux/tty.h&gt;&nbsp;&nbsp;&nbsp; // tty</span>ͷ�ļ����������й�<span
lang=EN-US>tty_io</span>������ͨ�ŷ���Ĳ�����������</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>11</span></u>
#include &lt;linux/kernel.h&gt; // </span>�ں�ͷ�ļ�������һЩ�ں˳��ú�����ԭ�ζ��塣</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>12</span></u>
#include &lt;linux/config.h&gt; // </span>�ں˳��������ļ���������Ҫʹ�����е�ϵͳ���Ƴ���������Ϣ��</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>13</span></u>
#include &lt;asm/segment.h&gt;&nbsp; // </span>�β���ͷ�ļ����������йضμĴ���������Ƕ��ʽ��ຯ����</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>14</span></u>
#include &lt;sys/times.h&gt;&nbsp;&nbsp;&nbsp; // </span>�����˽���������ʱ��Ľṹ<span
lang=EN-US>tms</span>�Լ�<span lang=EN-US>times()</span>����ԭ�͡�</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>15</span></u>
#include &lt;sys/utsname.h&gt;&nbsp; // </span>ϵͳ���ƽṹͷ�ļ���</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>16</span></u>
#include &lt;sys/param.h&gt;&nbsp;&nbsp;&nbsp; // </span>ϵͳ����ͷ�ļ�������ϵͳһЩȫ�ֳ������š�����<span
lang=EN-US>HZ</span>�ȡ�</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>17</span></u>
#include &lt;sys/resource.h&gt; // </span>ϵͳ��Դͷ�ļ��������йؽ�����Դʹ������Ľṹ����Ϣ��</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>18</span></u>
#include &lt;string.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span>�ַ���ͷ�ļ����ַ������ڴ��ֽ����в���������</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>19</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>20</span></u> <b><i>/*
</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>21</span></u> <b><i>&nbsp;*
The timezone where the local system is located.&nbsp; Used as a default by some</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>22</span></u> <b><i>&nbsp;*
programs who obtain this value by using gettimeofday.</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>23</span></u> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /* </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��ϵͳ���ڵ�ʱ����<span
lang=EN-US>timezone</span>������ΪĳЩ����ʹ��<span lang=EN-US>gettimeofday</span>ϵͳ���û�ȡ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>ʱ����Ĭ��ֵ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ʱ���ṹ<span lang=EN-US>timezone</span>��<span
lang=EN-US>1</span>���ֶΣ�<span lang=EN-US>tz_minuteswest</span>����ʾ��������α�׼ʱ��<span
lang=EN-US>GMT</span>�����ķ���</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>������<span lang=EN-US>2</span>���ֶΣ�<span
lang=EN-US>tz_dsttime</span>��������ʱ<span lang=EN-US>DST</span>��<span lang=EN-US>Daylight
Savings Time</span>���������͡� �ýṹ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>������<span lang=EN-US>include/sys/time.h</span>�С�</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>24</span></u>
struct <u><span style='color:blue'>timezone</span></u> <u><span
style='color:blue'>sys_tz</span></u> = { 0, 0};</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>25</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ݽ������<span
lang=EN-US>pgrp</span>ȡ�ý����������Ự��<span lang=EN-US>session</span>���š��ú�����<span
lang=EN-US>kernel/exit.c</span>��ʵ�֡�</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>26</span></u>
extern int <u><span style='color:blue'>session_of_pgrp</span></u>(int pgrp);</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>27</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�������ں�ʱ�䣨<span
lang=EN-US>ftime �C Fetch time</span>����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���·���ֵ��<span
lang=EN-US>-ENOSYS</span>��ϵͳ���ú�������ʾ�ڱ��汾�ں��л�δʵ�֡�</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>28</span></u> int
<u><span style='color:blue'>sys_ftime</span></u>()</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>29</span></u> {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>30</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>31</span></u> }</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>32</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>33</span></u> int
<u><span style='color:blue'>sys_break</span></u>()</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>34</span></u> {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>35</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>36</span></u> }</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>37</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ڵ�ǰ���̶��ӽ��̽��е���<span
lang=EN-US>(debugging)</span>��</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>38</span></u> int
<u><span style='color:blue'>sys_ptrace</span></u>()</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>39</span></u> {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>40</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>41</span></u> }</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>42</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�ı䲢��ӡ�ն������á�</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>43</span></u> int
<u><span style='color:blue'>sys_stty</span></u>()</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>44</span></u> {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>45</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>46</span></u> }</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>47</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ȡ�ն���������Ϣ��</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>48</span></u> int
<u><span style='color:blue'>sys_gtty</span></u>()</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>49</span></u> {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>50</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>51</span></u> }</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>52</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�޸��ļ�����</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>53</span></u> int
<u><span style='color:blue'>sys_rename</span></u>()</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>54</span></u> {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>55</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>56</span></u> }</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>57</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>58</span></u> int
<u><span style='color:blue'>sys_prof</span></u>()</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>59</span></u> {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>60</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>61</span></u> }</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>62</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>63</span></u> <b><i>/*</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>64</span></u> <b><i>&nbsp;*
This is done BSD-style, with no consideration of the saved gid, except</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>65</span></u> <b><i>&nbsp;*
that if you set the effective gid, it sets the saved gid too.&nbsp; This </i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>66</span></u> <b><i>&nbsp;*
makes it possible for a setgid program to completely drop its privileges,</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>67</span></u> <b><i>&nbsp;*
which is often a useful assertion to make when you are doing a security</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>68</span></u> <b><i>&nbsp;*
audit over a program.</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>69</span></u> <b><i>&nbsp;*</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>70</span></u> <b><i>&nbsp;*
The general idea is that a program which uses just setregid() will be</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>71</span></u> <b><i>&nbsp;*
100% compatible with BSD.&nbsp; A program which uses just setgid() will be</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>72</span></u> <b><i>&nbsp;*
100% compatible with POSIX w/ Saved ID's. </i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>73</span></u> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /*</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>������<span
lang=EN-US>BSD</span>��ʽ��ʵ�֣�û�п��Ǳ����<span lang=EN-US>gid</span>��<span lang=EN-US>saved
gid</span>��<span lang=EN-US>sgid</span>�������˵���</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��������Ч��<span
lang=EN-US>gid</span>��<span lang=EN-US>effective gid</span>��<span lang=EN-US>egid</span>��ʱ�������<span
lang=EN-US>gid</span>Ҳ�ᱻ���á���ʹ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��һ��ʹ��<span
lang=EN-US>setgid</span>�ĳ��������ȫ��������Ȩ�������ڶ�һ��������а�ȫ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��ʱ����ͨ����һ�ֺܺõĴ���������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>������Ŀ�����һ��ʹ��<span
lang=EN-US>setregid()</span>�ĳ��򽫻���<span lang=EN-US>BSD</span>ϵͳ<span
lang=EN-US>100%</span>�ļ��ݡ���һ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��ʹ��<span
lang=EN-US>setgid()</span>�ͱ����<span lang=EN-US>gid</span>�ĳ��򽫻���<span
lang=EN-US>POSIX 100%</span>�ļ��ݡ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���õ�ǰ�����ʵ���Լ�<span
lang=EN-US>/</span>������Ч��<span lang=EN-US>ID</span>��<span lang=EN-US>gid</span>�����������û�г����û���Ȩ����ôֻ�ܻ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ʵ����<span lang=EN-US>ID
</span>����Ч��<span lang=EN-US> ID</span>�����������г����û���Ȩ����������������Ч�ĺ�ʵ�ʵ���</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // ID</span>��������<span
lang=EN-US>gid</span>��<span lang=EN-US>saved gid</span>�������ó�����Ч<span
lang=EN-US>gid</span>��ʵ����<span lang=EN-US>ID</span>��ָ���̵�ǰ��<span lang=EN-US>gid</span>��</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>74</span></u> int
<u><span style='color:blue'>sys_setregid</span></u>(int rgid, int egid)</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>75</span></u> {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>76</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (rgid&gt;0) {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>77</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if ((<u><span style='color:blue'>current</span></u>-&gt;gid == rgid) || </span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>78</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>suser</span></u>())</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>79</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;gid = rgid;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>80</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
else</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>81</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(-<u><span
style='color:blue'>EPERM</span></u>);</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>82</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>83</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (egid&gt;0) {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>84</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if ((<u><span style='color:blue'>current</span></u>-&gt;gid == egid) ||</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>85</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(<u><span style='color:blue'>current</span></u>-&gt;egid == egid) ||</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>86</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>suser</span></u>()) {</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>87</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;egid = egid;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>88</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;sgid = egid;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>89</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
} else</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>90</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return(-<u><span style='color:blue'>EPERM</span></u>);</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>91</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>92</span></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return 0;</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>93</span></u> }</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>94</span></u> </span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>95</span></u> <b><i>/*</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>96</span></u> <b><i>&nbsp;*
setgid() is implemeneted like SysV w/ SAVED_IDS </i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>97</span></u> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /*</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * setgid()</span>��ʵ�������<span
lang=EN-US>SAVED_IDS</span>��<span lang=EN-US>SYSV</span>��ʵ�ַ������ơ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ý������<span
lang=EN-US>(gid)</span>���������û�г����û���Ȩ��������ʹ�� <span lang=EN-US>setgid() </span>������Ч<span
lang=EN-US>gid</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��<span lang=EN-US>effective
gid</span>������Ϊ���䱣��<span lang=EN-US>gid(saved gid)</span>����ʵ��<span lang=EN-US>gid(real
gid)</span>���������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�г����û���Ȩ����ʵ��<span
lang=EN-US>gid</span>����Ч<span lang=EN-US>gid</span>�ͱ���<span lang=EN-US>gid</span>�������óɲ���ָ����<span
lang=EN-US>gid</span>��</p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>98</span></u> int
<u><span style='color:blue'>sys_setgid</span></u>(int gid)</span></p>

<p class=a><span lang=EN-US>&nbsp;<u><span style='color:blue'>99</span></u> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>100</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<u><span
style='color:blue'>suser</span></u>())</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>101</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;gid = <u><span
style='color:blue'>current</span></u>-&gt;egid = <u><span style='color:blue'>current</span></u>-&gt;sgid
= gid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>102</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if ((gid == <u><span
style='color:blue'>current</span></u>-&gt;gid) || (gid == <u><span
style='color:blue'>current</span></u>-&gt;sgid))</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>103</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;egid = gid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>104</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>105</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>106</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>107</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>108</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�򿪻�رս��̼��ʹ��ܡ�</p>

<p class=a><u><span lang=EN-US style='color:blue'>109</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_acct</span></u>()</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>110</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>111</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -<u><span
style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>112</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>113</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ӳ�����������ڴ浽���̵������ַ�ռ䡣</p>

<p class=a><u><span lang=EN-US style='color:blue'>114</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_phys</span></u>()</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>115</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>116</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -<u><span
style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>117</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>118</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>119</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_lock</span></u>()</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>120</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>121</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -<u><span
style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>122</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>123</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>124</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_mpx</span></u>()</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>125</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>126</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -<u><span
style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>127</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>128</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>129</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_ulimit</span></u>()</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>130</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>131</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -<u><span
style='color:blue'>ENOSYS</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>132</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>133</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ش�<span lang=EN-US> 1970<span lang=EN-US><span lang=EN-US>��1</span></span><span lang=EN-US><span lang=EN-US>��1</span></span><span
 lang=EN-US><span lang=EN-US>��</span></span>00:00:00 GMT </span>��ʼ��ʱ��ʱ��ֵ���룩�����<span
lang=EN-US>tloc</span>��Ϊ<span lang=EN-US>null</span>��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ʱ��ֵҲ�洢�����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ڲ�����һ��ָ�룬������ָλ�����û��ռ䣬�����Ҫʹ�ú���
<span lang=EN-US>put_fs_long() </span>��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ʸ�ֵ���ڽ����ں�������ʱ���μĴ���<span
lang=EN-US>fs</span>��Ĭ�ϵ�ָ��ǰ�û����ݿռ䡣��˸�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�����Ϳ�����<span
lang=EN-US>fs</span>�������û��ռ��е�ֵ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>134</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_time</span></u>(long * tloc)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>135</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>136</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int i;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>137</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>138</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = <u><span
style='color:blue'>CURRENT_TIME</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>139</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tloc) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>140</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>verify_area</span></u>(tloc,4);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// </span>��֤�ڴ������Ƿ񹻣�������<span lang=EN-US>4</span>�ֽڣ���</p>

<p class=a><u><span lang=EN-US style='color:blue'>141</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(i,(unsigned long *)tloc);&nbsp;&nbsp;
// </span>�����û����ݶ�<span lang=EN-US>tloc</span>����</p>

<p class=a><u><span lang=EN-US style='color:blue'>142</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>143</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return i;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>144</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>145</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>146</span></u><span
lang=EN-US> <b><i>/*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>147</span></u><span
lang=EN-US> <b><i>&nbsp;* Unprivileged users may change the real user id to the
effective uid</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>148</span></u><span
lang=EN-US> <b><i>&nbsp;* or vice versa.&nbsp; (BSD-style)</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>149</span></u><span
lang=EN-US> <b><i>&nbsp;*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>150</span></u><span
lang=EN-US> <b><i>&nbsp;* When you set the effective uid, it sets the saved uid
too.&nbsp; This </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>151</span></u><span
lang=EN-US> <b><i>&nbsp;* makes it possible for a setuid program to completely
drop its privileges,</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>152</span></u><span
lang=EN-US> <b><i>&nbsp;* which is often a useful assertion to make when you
are doing a security</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>153</span></u><span
lang=EN-US> <b><i>&nbsp;* audit over a program.</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>154</span></u><span
lang=EN-US> <b><i>&nbsp;*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>155</span></u><span
lang=EN-US> <b><i>&nbsp;* The general idea is that a program which uses just
setreuid() will be</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>156</span></u><span
lang=EN-US> <b><i>&nbsp;* 100% compatible with BSD.&nbsp; A program which uses just
setuid() will be</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>157</span></u><span
lang=EN-US> <b><i>&nbsp;* 100% compatible with POSIX w/ Saved ID's. </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>158</span></u><span
lang=EN-US> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /* </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>����Ȩ���û����Լ�ʵ�ʵ�<span
lang=EN-US>uid</span>��<span lang=EN-US>real uid</span>���ĳ���Ч��<span lang=EN-US>uid</span>��<span
lang=EN-US>effective uid</span>����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��֮ҲȻ����<span
lang=EN-US>BSD</span>��ʽ��ʵ�֣�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>����������Ч��<span
lang=EN-US>uid </span>ʱ����ͬʱҲ�����˱����<span lang=EN-US> uid</span>����ʹ��һ��ʹ��<span
lang=EN-US> setuid</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�ĳ��������ȫ��������Ȩ�������ڶ�һ��������а�ȫ���ʱ����ͨ����һ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�ܺõĴ���������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>������Ŀ�����һ��ʹ��<span
lang=EN-US> setreuid()</span>�ĳ��򽫻���<span lang=EN-US> BSD</span>ϵͳ<span
lang=EN-US>100%</span>�ļ��ݡ���һ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��ʹ��<span
lang=EN-US>setuid()</span>�ͱ����<span lang=EN-US>gid</span>�ĳ��򽫻���<span
lang=EN-US>POSIX 100%</span>�ļ��ݡ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���������ʵ���Լ�<span
lang=EN-US>/</span>������Ч���û�<span lang=EN-US>ID</span>��<span lang=EN-US>uid</span>�����������û�г����û���Ȩ����ôֻ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>������ʵ�ʵ�<span
lang=EN-US>uid </span>����Ч��<span lang=EN-US>uid</span>�����������г����û���Ȩ����������������Ч�ĺ�ʵ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�ʵ��û�<span lang=EN-US>ID</span>�������<span
lang=EN-US>uid</span>��<span lang=EN-US>saved uid</span>�������ó�����Ч<span
lang=EN-US>uid</span>ֵͬ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>159</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_setreuid</span></u>(int ruid,
int euid)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>160</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>161</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int old_ruid = <u><span
style='color:blue'>current</span></u>-&gt;uid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>162</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>163</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ruid&gt;0) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>164</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if ((<u><span style='color:blue'>current</span></u>-&gt;euid==ruid) ||</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>165</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(old_ruid == ruid) ||</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>166</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>suser</span></u>())</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>167</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;uid = ruid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>168</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
else</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>169</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return(-<u><span style='color:blue'>EPERM</span></u>);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>170</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>171</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (euid&gt;0) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>172</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if
((old_ruid == euid) ||</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>173</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(<u><span style='color:blue'>current</span></u>-&gt;euid == euid) ||</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>174</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>suser</span></u>()) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>175</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;euid = euid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>176</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;suid = euid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>177</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
} else {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>178</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;uid = old_ruid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>179</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return(-<u><span style='color:blue'>EPERM</span></u>);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>180</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>181</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>182</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>183</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>184</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>185</span></u><span
lang=EN-US> <b><i>/*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>186</span></u><span
lang=EN-US> <b><i>&nbsp;* setuid() is implemeneted like SysV w/ SAVED_IDS </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>187</span></u><span
lang=EN-US> <b><i>&nbsp;* </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>188</span></u><span
lang=EN-US> <b><i>&nbsp;* Note that SAVED_ID's is deficient in that a setuid
root program</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>189</span></u><span
lang=EN-US> <b><i>&nbsp;* like sendmail, for example, cannot set its uid to be
a normal </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>190</span></u><span
lang=EN-US> <b><i>&nbsp;* user and then switch back, because if you're root,
setuid() sets</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>191</span></u><span
lang=EN-US> <b><i>&nbsp;* the saved uid too.&nbsp; If you don't like this,
blame the bright people</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>192</span></u><span
lang=EN-US> <b><i>&nbsp;* in the POSIX commmittee and/or USG.&nbsp; Note that
the BSD-style setreuid()</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>193</span></u><span
lang=EN-US> <b><i>&nbsp;* will allow a root program to temporarily drop
privileges and be able to</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>194</span></u><span
lang=EN-US> <b><i>&nbsp;* regain them by swapping the real and effective
uid.&nbsp; </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>195</span></u><span
lang=EN-US> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp; &nbsp;/*</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * setuid()</span>��ʵ�������<span
lang=EN-US>SAVED_IDS</span>��<span lang=EN-US>SYSV</span>��ʵ�ַ������ơ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; *</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��ע��ʹ��<span
lang=EN-US>SAVED_ID</span>��<span lang=EN-US>setuid()</span>��ĳЩ�����ǲ����Ƶġ����磬һ��ʹ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * setuid</span>�ĳ����û�����<span
lang=EN-US>sendmail</span>������������<span lang=EN-US>uid</span>���ó�һ����ͨ�û���</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * uid</span>��Ȼ���ٽ��������� ��Ϊ�������һ�������û���<span
lang=EN-US>setuid() </span>Ҳͬʱ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>���ñ����<span
lang=EN-US>uid</span>������㲻ϲ�������������Ļ��������<span lang=EN-US>POSIX</span>��ί���Լ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * /</span>����<span
lang=EN-US>USG</span>�еĴ����˰ɡ�������ע��<span lang=EN-US>BSD</span>��ʽ��<span
lang=EN-US>setreuid()</span>ʵ���ܹ�����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>һ�������û�������ʱ������Ȩ��������ͨ������ʵ�ʵĺ���Ч��<span
lang=EN-US> uid </span>��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�ٴλ����Ȩ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���������û�<span
lang=EN-US>ID</span>��<span lang=EN-US>uid</span>�����������û�г����û���Ȩ��������ʹ��<span
lang=EN-US>setuid()</span>������Ч��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // uid</span>��<span lang=EN-US>effective
uid</span>�����ó��䱣���<span lang=EN-US>uid</span>��<span lang=EN-US>saved uid</span>������ʵ�ʵ�<span
lang=EN-US>uid</span>��<span lang=EN-US>real uid</span>����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��������г����û���Ȩ����ʵ�ʵ�<span
lang=EN-US>uid</span>����Ч��<span lang=EN-US>uid</span>�ͱ����<span lang=EN-US>uid</span>���ᱻ���óɲ���ָ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>uid</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>196</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_setuid</span></u>(int uid)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>197</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>198</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<u><span
style='color:blue'>suser</span></u>())</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>199</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;uid = <u><span
style='color:blue'>current</span></u>-&gt;euid = <u><span style='color:blue'>current</span></u>-&gt;suid
= uid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>200</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if ((uid == <u><span
style='color:blue'>current</span></u>-&gt;uid) || (uid == <u><span
style='color:blue'>current</span></u>-&gt;suid))</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>201</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;euid = uid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>202</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>203</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>204</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(0);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>205</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>206</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ϵͳ����ʱ�䡣����<span
lang=EN-US>tptr</span>�Ǵ�<span
 lang=EN-US>1970</span>��<span lang=EN-US>1</span>��<span lang=EN-US>1</span>��<span
lang=EN-US>00:00:00 GMT</span>��ʼ��ʱ��ʱ��ֵ���룩��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ý��̱�����г����û�Ȩ�ޡ�����<span
lang=EN-US>HZ=100</span>�����ں�ϵͳ����Ƶ�ʡ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ڲ�����һ��ָ�룬������ָλ�����û��ռ䣬�����Ҫʹ�ú���<span
lang=EN-US>get_fs_long()</span>�����ʸ�</p>

<p class=a><span lang=EN-US>&nbsp; &nbsp;&nbsp;// </span>ֵ���ڽ����ں�������ʱ���μĴ��� <span
lang=EN-US>fs </span>��Ĭ�ϵ�ָ��ǰ�û����ݿռ䡣��˸ú����Ϳ���</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��<span lang=EN-US>fs</span>�������û��ռ��е�ֵ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���������ṩ�ĵ�ǰʱ��ֵ��ȥϵͳ�Ѿ����е�ʱ����ֵ��<span
lang=EN-US>jiffies/HZ</span>�����ǿ���ʱ����ֵ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>207</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_stime</span></u>(long * tptr)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>208</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>209</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!<u><span
style='color:blue'>suser</span></u>())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// </span>������ǳ����û���������أ����ɣ���</p>

<p class=a><u><span lang=EN-US style='color:blue'>210</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>211</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>startup_time</span></u> = <u><span style='color:blue'>get_fs_long</span></u>((unsigned
long *)tptr) - <u><span style='color:blue'>jiffies</span></u>/<u><span
style='color:blue'>HZ</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>212</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>jiffies_offset</span></u> = 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>213</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>214</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>215</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ȡ��ǰ��������ʱ��ͳ��ֵ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��<span lang=EN-US>tbuf</span>��ָ�û����ݿռ䴦����<span
lang=EN-US>tms</span>�ṹ����������ʱ��ͳ��ֵ��<span lang=EN-US>tms</span>�ṹ�а��������û�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ʱ�䡢�ںˣ�ϵͳ��ʱ�䡢�ӽ����û�����ʱ�䡢�ӽ���ϵͳ����ʱ�䡣��������ֵ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ϵͳ���е���ǰ���������</p>

<p class=a><u><span lang=EN-US style='color:blue'>216</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_times</span></u>(struct <u><span
style='color:blue'>tms</span></u> * tbuf)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>217</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>218</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tbuf) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>219</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>verify_area</span></u>(tbuf,sizeof *tbuf);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>220</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>current</span></u>-&gt;<u><span
style='color:blue'>utime</span></u>,(unsigned long *)&amp;tbuf-&gt;tms_utime);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>221</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>current</span></u>-&gt;<u><span
style='color:blue'>stime</span></u>,(unsigned long *)&amp;tbuf-&gt;tms_stime);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>222</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>current</span></u>-&gt;cutime,(unsigned
long *)&amp;tbuf-&gt;tms_cutime);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>223</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>current</span></u>-&gt;cstime,(unsigned
long *)&amp;tbuf-&gt;tms_cstime);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>224</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>225</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <u><span
style='color:blue'>jiffies</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>226</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>227</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>������<span lang=EN-US>end_data_seg</span>��ֵ����������ϵͳȷʵ���㹻���ڴ棬���ҽ���û�г�Խ���������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�δ�Сʱ���ú����������ݶ�ĩβΪ<span
lang=EN-US>end_data_seg</span>ָ����ֵ����ֵ������ڴ����β����Ҫ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>С�ڶ�ջ��β<span
lang=EN-US>16KB</span>������ֵ�����ݶε��½�βֵ���������ֵ��Ҫ��ֵ��ͬ��������д���</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���������ú����������û�ֱ�ӵ��ã�����<span
lang=EN-US>libc</span>�⺯�����а�װ�����ҷ���ֵҲ��һ����</p>

<p class=a><u><span lang=EN-US style='color:blue'>228</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_brk</span></u>(unsigned long
end_data_seg)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>229</span></u><span
lang=EN-US> {</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�������ֵ���ڴ����β������С�ڣ���ջ<span
lang=EN-US> - 16KB</span>���������������ݶν�βֵ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>230</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (end_data_seg
&gt;= <u><span style='color:blue'>current</span></u>-&gt;end_code &amp;&amp;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>231</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
end_data_seg &lt; <u><span style='color:blue'>current</span></u>-&gt;start_stack
- 16384)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>232</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;<u><span style='color:blue'>brk</span></u>
= end_data_seg;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>233</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <u><span
style='color:blue'>current</span></u>-&gt;<u><span style='color:blue'>brk</span></u>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;// </span>���ؽ��̵�ǰ�����ݶν�βֵ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>234</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>235</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>236</span></u><span
lang=EN-US> <b><i>/*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>237</span></u><span
lang=EN-US> <b><i>&nbsp;* This needs some heave checking ...</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>238</span></u><span
lang=EN-US> <b><i>&nbsp;* I just haven't get the stomach for it. I also don't
fully</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>239</span></u><span
lang=EN-US> <b><i>&nbsp;* understand sessions/pgrp etc. Let somebody who does
explain it.</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>240</span></u><span
lang=EN-US> <b><i>&nbsp;*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>241</span></u><span
lang=EN-US> <b><i>&nbsp;* OK, I think I have the protection semantics right....
this is really</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>242</span></u><span
lang=EN-US> <b><i>&nbsp;* only important on a multi-user system anyway, to make
sure one user</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>243</span></u><span
lang=EN-US> <b><i>&nbsp;* can't send a signal to a process owned by
another.&nbsp; -TYT, 12/12/91</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>244</span></u><span
lang=EN-US> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /*</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>���������ҪĳЩ�ϸ�ļ��<span
lang=EN-US>��</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��ֻ��û��θ��������Щ����Ҳ����ȫ����<span
lang=EN-US>sessions/pgrp</span>�ȵĺ��塣������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�˽����ǵ��������ɡ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * OK</span>���������Ѿ���ȷ��ʵ���˱�������<span
lang=EN-US>...</span>����֮������ʵֻ�Զ��û�ϵͳ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��Ҫ�ģ���ȷ��һ���û������������û��Ľ��̷����źš�<span
lang=EN-US> -TYT 12/12/91</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ָ������<span
lang=EN-US>pid</span>�Ľ������Ϊ<span lang=EN-US>pgid</span>��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>pid
</span>��ָ�����̵Ľ��̺š������Ϊ<span lang=EN-US>0</span>������<span lang=EN-US>pid</span>���ڵ�ǰ���̵Ľ��̺š�����<span
lang=EN-US>pgid</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ָ���Ľ�����š������Ϊ<span
lang=EN-US>0</span>�����������ڽ���<span lang=EN-US>pid</span>�Ľ�����š�����ú������ڽ�����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��һ���������Ƶ���һ�������飬���������������������ͬһ���Ự<span
lang=EN-US>(session)</span>��������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����£�����<span
lang=EN-US>pgid </span>ָ����Ҫ��������н�����<span lang=EN-US>ID</span>����ʱ����ĻỰ<span
lang=EN-US>ID</span>�����뽫Ҫ�����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�̵���ͬ<span lang=EN-US>(263</span>��<span
lang=EN-US>)</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>245</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_setpgid</span></u>(int pid, int
pgid)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>246</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>247</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int i; </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>248</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�������<span lang=EN-US>pid</span>Ϊ<span
lang=EN-US>0</span>����<span lang=EN-US>pid</span>ȡֵΪ��ǰ���̵Ľ��̺�<span lang=EN-US>pid</span>���������<span
lang=EN-US>pgid</span>Ϊ<span lang=EN-US>0</span>����<span lang=EN-US>pgid</span>Ҳ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ȡֵΪ��ǰ���̵�<span
lang=EN-US>pid</span>��<span lang=EN-US>[?? </span>������<span lang=EN-US>POSIX</span>��׼�������г���<span
lang=EN-US> ]</span>����<span lang=EN-US> pgid</span>С��<span lang=EN-US>0</span>���򷵻�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��Ч�����롣</p>

<p class=a><u><span lang=EN-US style='color:blue'>249</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!pid)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>250</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pid = <u><span style='color:blue'>current</span></u>-&gt;pid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>251</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!pgid)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>252</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pgid = <u><span style='color:blue'>current</span></u>-&gt;pid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>253</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (pgid &lt; 0)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>254</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EINVAL</span></u>;</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ɨ���������飬����ָ�����̺�<span
lang=EN-US> pid </span>����������ҵ��˽��̺���<span lang=EN-US>pid </span>�Ľ��̣����Ҹý���</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�ĸ����̾��ǵ�ǰ���̻��߸ý��̾��ǵ�ǰ���̣���ô���������Ѿ��ǻỰ���죬��������ء�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��������ĻỰ�ţ�<span
lang=EN-US>session</span>���뵱ǰ���̵Ĳ�ͬ������ָ���Ľ������<span lang=EN-US>pgid</span>��<span
lang=EN-US>pid</span>��ͬ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // pgid </span>�����������Ự���뵱ǰ���������Ự�Ų�ͬ����Ҳ�������ء�
����Ѳ��ҵ��Ľ��̵�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // pgrp</span>����Ϊ<span
lang=EN-US>pgid</span>��������<span lang=EN-US>0</span>����û���ҵ�ָ��<span lang=EN-US>pid</span>�Ľ��̣��򷵻ؽ��̲����ڳ����롣</p>

<p class=a><u><span lang=EN-US style='color:blue'>255</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i=0 ; i&lt;<u><span
style='color:blue'>NR_TASKS</span></u> ; i++)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>256</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (<u><span style='color:blue'>task</span></u>[i] &amp;&amp; (<u><span
style='color:blue'>task</span></u>[i]-&gt;pid == pid) &amp;&amp;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>257</span></u><span
lang=EN-US> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<u><span
style='color:blue'>task</span></u>[i]-&gt;p_pptr == <u><span style='color:blue'>current</span></u>)
|| </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>258</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(<u><span style='color:blue'>task</span></u>[i] == <u><span style='color:blue'>current</span></u>)))
{</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>259</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (<u><span style='color:blue'>task</span></u>[i]-&gt;leader)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>260</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>261</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if ((<u><span style='color:blue'>task</span></u>[i]-&gt;session != <u><span
style='color:blue'>current</span></u>-&gt;session) ||</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>262</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
((pgid != pid) &amp;&amp; </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>263</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(<u><span style='color:blue'>session_of_pgrp</span></u>(pgid) != <u><span
style='color:blue'>current</span></u>-&gt;session)))</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>264</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>265</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>task</span></u>[i]-&gt;pgrp = pgid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>266</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>267</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>268</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -<u><span
style='color:blue'>ESRCH</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>269</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>270</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ص�ǰ���̵Ľ�����š���<span
lang=EN-US>getpgid(0)</span>��ͬ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>271</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_getpgrp</span></u>(void)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>272</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>273</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <u><span
style='color:blue'>current</span></u>-&gt;pgrp;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>274</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>275</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����һ���Ự<span
lang=EN-US>(session)</span>����������<span lang=EN-US>leader=1</span>��������������Ự��<span
lang=EN-US>=</span>�����<span lang=EN-US>=</span>����̺š�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�����ǰ�������ǻỰ���첢�Ҳ��ǳ����û�����������ء��������õ�ǰ����Ϊ�»Ự</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���죨<span lang=EN-US>leader
= 1</span>�����������õ�ǰ���̻Ự�� <span lang=EN-US>session</span>�����<span lang=EN-US>pgrp</span>�����ڽ��̺�<span
lang=EN-US>pid</span>��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�������õ�ǰ����û�п����նˡ����ϵͳ���÷��ػỰ�š�</p>

<p class=a><u><span lang=EN-US style='color:blue'>276</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_setsid</span></u>(void)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>277</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>278</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<u><span
style='color:blue'>current</span></u>-&gt;leader &amp;&amp; !<u><span
style='color:blue'>suser</span></u>())</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>279</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>280</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>current</span></u>-&gt;leader = 1;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>281</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>current</span></u>-&gt;session = <u><span style='color:blue'>current</span></u>-&gt;pgrp
= <u><span style='color:blue'>current</span></u>-&gt;pid;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>282</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>current</span></u>-&gt;tty = -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// </span>��ʾ��ǰ����û�п����նˡ�</p>

<p class=a><u><span lang=EN-US style='color:blue'>283</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <u><span
style='color:blue'>current</span></u>-&gt;pgrp;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>284</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>285</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>286</span></u><span
lang=EN-US> <b><i>/*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>287</span></u><span
lang=EN-US> <b><i>&nbsp;* Supplementary group ID's</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>288</span></u><span
lang=EN-US> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /*</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>���̵������û���š�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ȡ��ǰ�������������û���š�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�������ݽṹ��<span
lang=EN-US>groups[]</span>���鱣���Ž���ͬʱ�����Ķ���û���š������鹲<span lang=EN-US>NGROUPS</span>���</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ĳ���ֵ��<span
lang=EN-US>NOGROUP</span>����Ϊ<span lang=EN-US> -1</span>�������ʾ�Ӹ��ʼ�Ժ���������С������������б�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>������û���š�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>gidsetsize</span>�ǻ�ȡ���û���Ÿ�����<span
lang=EN-US>grouplist</span>�Ǵ洢��Щ�û���ŵ��û��ռ仺�档</p>

<p class=a><u><span lang=EN-US style='color:blue'>289</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_getgroups</span></u>(int
gidsetsize, <u><span style='color:blue'>gid_t</span></u> *grouplist)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>290</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>291</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int&nbsp;&nbsp;&nbsp;&nbsp; i;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>292</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>������֤<span lang=EN-US>grouplist</span>ָ����ָ���û�����ռ��Ƿ��㹻��Ȼ��ӵ�ǰ���̽ṹ��<span
lang=EN-US>groups[]</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���������ȡ���û���Ų����Ƶ��û������С��ڸ��ƹ����У����<span
lang=EN-US> groups[] </span>�е�����</p>

<p class=a><span lang=EN-US>&nbsp; &nbsp;&nbsp;// </span>���ڸ����Ĳ���<span
lang=EN-US> gidsetsize </span>��ָ���ĸ��������ʾ�û������Ļ���̫С���������µ�ǰ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����������ţ���˴˴�ȡ��Ų�����������ء������ƹ����������������᷵�ظ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�Ƶ��û���Ÿ�������<span
lang=EN-US>gidsetsize �C gid set size</span>���û���ż���С����</p>

<p class=a><u><span lang=EN-US style='color:blue'>293</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (gidsetsize)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>294</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>verify_area</span></u>(grouplist, sizeof(<u><span
style='color:blue'>gid_t</span></u>) * gidsetsize);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>295</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>296</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0; (i &lt;
<u><span style='color:blue'>NGROUPS</span></u>) &amp;&amp; (<u><span
style='color:blue'>current</span></u>-&gt;groups[i] != <u><span
style='color:blue'>NOGROUP</span></u>);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>297</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
i++, grouplist++) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>298</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (gidsetsize) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>299</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (i &gt;= gidsetsize)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>300</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EINVAL</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>301</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_word</span></u>(<u><span style='color:blue'>current</span></u>-&gt;groups[i],
(short *) grouplist);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>302</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>303</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>304</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(i);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// </span>����ʵ�ʺ��е��û���Ÿ�����</p>

<p class=a><u><span lang=EN-US style='color:blue'>305</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>306</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���õ�ǰ����ͬʱ���������������û���š�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>gidsetsize</span>�ǽ����õ��û���Ÿ�����<span
lang=EN-US>grouplist</span>�Ǻ����û���ŵ��û��ռ仺�档</p>

<p class=a><u><span lang=EN-US style='color:blue'>307</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_setgroups</span></u>(int
gidsetsize, <u><span style='color:blue'>gid_t</span></u> *grouplist)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>308</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>309</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int&nbsp;&nbsp;&nbsp;&nbsp; i;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>310</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���Ȳ�Ȩ�޺Ͳ�������Ч�ԡ�ֻ�г����û������޸Ļ����õ�ǰ���̵ĸ����û���ţ�����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���õ��������ܳ������̵�<span
lang=EN-US>groups[NGROUPS]</span>�����������Ȼ����û���������������û�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ţ���<span lang=EN-US>gidsetsize</span>����������Ƶĸ���û������<span
lang=EN-US>groups[]</span>���������һ��������ֵΪ<span lang=EN-US>-1</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���<span lang=EN-US>NOGROUP</span>�������������<span
lang=EN-US>0</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>311</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!<u><span
style='color:blue'>suser</span></u>())</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>312</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>313</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (gidsetsize &gt;
<u><span style='color:blue'>NGROUPS</span></u>)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>314</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EINVAL</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>315</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0; i &lt;
gidsetsize; i++, grouplist++) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>316</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;groups[i] = <u><span
style='color:blue'>get_fs_word</span></u>((unsigned short *) grouplist);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>317</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>318</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (i &lt; <u><span
style='color:blue'>NGROUPS</span></u>)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>319</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>current</span></u>-&gt;groups[i] = <u><span
style='color:blue'>NOGROUP</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>320</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>321</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>322</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��鵱ǰ�����Ƿ���ָ�����û���<span
lang=EN-US>grp</span>�С����򷵻�<span lang=EN-US>1</span>�����򷵻�<span lang=EN-US>0</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>323</span></u><span
lang=EN-US> int <u><span style='color:blue'>in_group_p</span></u>(<u><span
style='color:blue'>gid_t</span></u> grp)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>324</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>325</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int&nbsp;&nbsp;&nbsp;&nbsp; i;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>326</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�����ǰ���̵���Ч��ž���<span
lang=EN-US>grp</span>�����ʾ��������<span lang=EN-US>grp</span>�����顣��������<span
lang=EN-US>1</span>���������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���̵ĸ����û���������ɨ���Ƿ���<span
lang=EN-US> grp </span>������š���������Ҳ����<span lang=EN-US>1</span>����ɨ�赽ֵ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>Ϊ<span lang=EN-US>
NOGROUP </span>�����ʾ��ɨ����ȫ����Ч���û�з���ƥ�����ţ���˺�������<span lang=EN-US>0</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>327</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (grp == <u><span
style='color:blue'>current</span></u>-&gt;egid)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>328</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return 1;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>329</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>330</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0; i &lt; <u><span
style='color:blue'>NGROUPS</span></u>; i++) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>331</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (<u><span style='color:blue'>current</span></u>-&gt;groups[i] == <u><span
style='color:blue'>NOGROUP</span></u>)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>332</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
break;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>333</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (<u><span style='color:blue'>current</span></u>-&gt;groups[i] == grp)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>334</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return 1;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>335</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>336</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>337</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>338</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // utsname</span>�ṹ����һЩ�ַ����ֶΡ����ڱ���ϵͳ�����ơ����а���<span
lang=EN-US>5</span>���ֶΣ��ֱ��ǣ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ǰ����ϵͳ�����ơ�����ڵ����ƣ�������������ǰ����ϵͳ���м��𡢲���ϵͳ�汾</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���Լ�ϵͳ���е�Ӳ���������ơ��ýṹ������<span
lang=EN-US> include/sys/utsname.h </span>�ļ��С� ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�ں�ʹ��<span lang=EN-US>
include/linux/config.h </span>�ļ��еĳ����������������ǵ�Ĭ��ֵ�����Ƿֱ�Ϊ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // ��Linux</span>������<span
lang=EN-US>(none)</span>������<span
 lang=EN-US>0</span>������<span
 lang=EN-US>0.12</span>������<span lang=EN-US>i386<span
 lang=EN-US><span lang=EN-US>��</span></span><span lang=EN-US>��</span></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>339</span></u><span
lang=EN-US> static struct <u><span style='color:blue'>utsname</span></u> <u><span
style='color:blue'>thisname</span></u> = {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>340</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>UTS_SYSNAME</span></u>, <u><span style='color:blue'>UTS_NODENAME</span></u>,
<u><span style='color:blue'>UTS_RELEASE</span></u>, <u><span style='color:blue'>UTS_VERSION</span></u>,
<u><span style='color:blue'>UTS_MACHINE</span></u></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>341</span></u><span
lang=EN-US> };</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>342</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ȡϵͳ���Ƶ���Ϣ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>343</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_uname</span></u>(struct <u><span
style='color:blue'>utsname</span></u> * name)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>344</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>345</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int i;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>346</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>347</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!name) return -<u><span
style='color:blue'>ERROR</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>348</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>verify_area</span></u>(name,sizeof *name);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>349</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(i=0;i&lt;sizeof
*name;i++)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>350</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_byte</span></u>(((char *) &amp;<u><span
style='color:blue'>thisname</span></u>)[i],i+(char *) name);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>351</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>352</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>353</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>354</span></u><span
lang=EN-US> <b><i>/*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>355</span></u><span
lang=EN-US> <b><i>&nbsp;* Only sethostname; gethostname can be implemented by
calling uname()</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>356</span></u><span
lang=EN-US> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /*</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>ͨ������<span
lang=EN-US>uname()</span>ֻ��ʵ��<span lang=EN-US>sethostname</span>��<span
lang=EN-US>gethostname</span>��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ϵͳ��������ϵͳ������ڵ�������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>name</span>ָ��ָ���û��������к����������ַ����Ļ�������<span
lang=EN-US>len</span>���������ַ������ȡ�</p>

<p class=a><u><span lang=EN-US style='color:blue'>357</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_sethostname</span></u>(char
*name, int len)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>358</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>359</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int&nbsp;&nbsp;&nbsp;&nbsp; i;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>360</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ϵͳ������ֻ���ɳ����û����û��޸ģ��������������Ȳ��ܳ�����󳤶�<span
lang=EN-US>MAXHOSTNAMELEN</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>361</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!<u><span
style='color:blue'>suser</span></u>())</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>362</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>363</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (len &gt; <u><span
style='color:blue'>MAXHOSTNAMELEN</span></u>)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>364</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EINVAL</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>365</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i=0; i &lt;
len; i++) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>366</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if ((<u><span style='color:blue'>thisname</span></u>.nodename[i] = <u><span
style='color:blue'>get_fs_byte</span></u>(name+i)) == 0)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>367</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
break;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>368</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�ڸ�����Ϻ�����û��ṩ���ַ�����û�а���<span
lang=EN-US>NULL</span>�ַ�����ô�����Ƶ����������Ȼ�û��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>
MAXHOSTNAMELEN</span>�������������ַ���������һ��<span lang=EN-US>NULL</span>�����Ѿ�����<span
lang=EN-US> MAXHOSTNAMELEN</span>����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����������һ���ַ��ĳ�<span
lang=EN-US>NULL</span>�ַ�����<span lang=EN-US>thisname.nodename[min(i,MAXHOSTNAMELEN)]
= 0</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>369</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<u><span
style='color:blue'>thisname</span></u>.nodename[i]) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>370</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>thisname</span></u>.nodename[i&gt;<u><span
style='color:blue'>MAXHOSTNAMELEN</span></u> ? <u><span style='color:blue'>MAXHOSTNAMELEN</span></u>
: i] = 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>371</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>372</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>373</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>374</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ȡ��ǰ����ָ����Դ�Ľ���ֵ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���̵�����ṹ�ж�����һ������<span
lang=EN-US>rlim[RLIM_NLIMITS]</span>�����ڿ��ƽ���ʹ��ϵͳ��Դ�Ľ��ޡ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ÿ������һ��<span
lang=EN-US>rlimit </span>�ṹ�����а��������ֶΡ� һ��˵�����̶�ָ����Դ�ĵ�ǰ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ޣ�<span lang=EN-US>soft
limit</span>���������ƣ�����һ��˵��ϵͳ��ָ����Դ��������ƽ��ޣ�<span lang=EN-US>hard limit</span>��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��Ӳ���ƣ���<span
lang=EN-US> rlim[] </span>�����ÿһ���Ӧϵͳ�Ե�ǰ����һ����Դ�Ľ�����Ϣ��<span lang=EN-US>Linux 0.12</span></p>

<p class=a><span lang=EN-US>&nbsp; &nbsp;&nbsp;// </span>ϵͳ����<span lang=EN-US>6</span>����Դ�涨�˽��ޣ���<span
lang=EN-US>RLIM_NLIMITS=6</span>����ο�ͷ�ļ�<span lang=EN-US>include/sys/resource.h</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�е�<span lang=EN-US>41 ��
46</span>�е�˵����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>
resource </span>ָ��������ѯ����Դ���ƣ�ʵ������������ṹ��<span lang=EN-US>rlim[]</span>�����������ֵ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>rlim</span>��ָ��<span
lang=EN-US>rlimit</span>�ṹ���û�������ָ�룬���ڴ��ȡ�õ���Դ������Ϣ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>375</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_getrlimit</span></u>(int
resource, struct <u><span style='color:blue'>rlimit</span></u> *rlim)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>376</span></u><span
lang=EN-US> {</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ѯ����Դ<span
lang=EN-US>resource</span>ʵ�����ǽ�������ṹ��<span lang=EN-US>rlim[]</span>�����������ֵ��������ֵ��Ȼ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����������������<span
lang=EN-US> RLIM_NLIMITS</span>������֤��<span lang=EN-US> rlim </span>ָ����ָ�û������㹻�Ժ�����Ͱ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ָ������Դ<span
lang=EN-US>resource</span>�ṹ��Ϣ���Ƶ��û������У�������<span lang=EN-US>0</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>377</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (resource &gt;= <u><span
style='color:blue'>RLIM_NLIMITS</span></u>)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>378</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EINVAL</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>379</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>verify_area</span></u>(rlim,sizeof *rlim);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>380</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>current</span></u>-&gt;rlim[resource].rlim_cur,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span>��ǰ����������ֵ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>381</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(unsigned long *) rlim);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>382</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>current</span></u>-&gt;rlim[resource].rlim_max,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span>ϵͳ��Ӳ������ֵ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>383</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
((unsigned long *) rlim)+1);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>384</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>385</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>386</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���õ�ǰ����ָ����Դ�Ľ���ֵ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>
resource </span>ָ���������ý��޵���Դ���ƣ�ʵ������������ṹ��<span lang=EN-US>rlim[]</span>���������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ֵ������<span lang=EN-US>rlim</span>��ָ��<span
lang=EN-US>rlimit</span>�ṹ���û�������ָ�룬�����ں˶�ȡ�µ���Դ������Ϣ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>387</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_setrlimit</span></u>(int
resource, struct <u><span style='color:blue'>rlimit</span></u> *rlim)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>388</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>389</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct <u><span
style='color:blue'>rlimit</span></u> new, *old;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>390</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�����жϲ���<span
lang=EN-US>resource</span>������ṹ<span lang=EN-US>rlim[]</span>������ֵ����Ч�ԡ�Ȼ������<span
lang=EN-US>rlimit</span>�ṹָ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // old</span>ָ��ָ��������ṹ��ָ����Դ�ĵ�ǰ<span
lang=EN-US>rlimit</span>�ṹ��Ϣ�����Ű��û��ṩ����Դ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��Ϣ���Ƶ���ʱ<span
lang=EN-US>rlimit</span>�ṹ<span lang=EN-US>new</span>�С���ʱ����жϳ�<span lang=EN-US>new</span>�ṹ�е�������ֵ��Ӳ����ֵ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ڽ��̸���ԴԭӲ����ֵ�����ҵ�ǰ���ǳ����û��Ļ����ͷ������ɴ��������ʾ<span
lang=EN-US>new</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����Ϣ�������߽����ǳ����û����̣����޸�ԭ����ָ����Դ��Ϣ����<span
lang=EN-US>new</span>�ṹ�е���Ϣ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���ɹ�����<span lang=EN-US>0</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>391</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (resource &gt;= <u><span
style='color:blue'>RLIM_NLIMITS</span></u>)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>392</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EINVAL</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>393</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; old = <u><span
style='color:blue'>current</span></u>-&gt;rlim + resource;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// </span>��<span lang=EN-US>old = current-&gt;rlim[resource]</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>394</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new.rlim_cur = <u><span
style='color:blue'>get_fs_long</span></u>((unsigned long *) rlim);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>395</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new.rlim_max = <u><span
style='color:blue'>get_fs_long</span></u>(((unsigned long *) rlim)+1);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>396</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (((new.rlim_cur
&gt; old-&gt;rlim_max) ||</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>397</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(new.rlim_max &gt; old-&gt;rlim_max)) &amp;&amp;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>398</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
!<u><span style='color:blue'>suser</span></u>())</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>399</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>400</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *old = new;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>401</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>402</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>403</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>404</span></u><span
lang=EN-US> <b><i>/*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>405</span></u><span
lang=EN-US> <b><i>&nbsp;* It would make sense to put struct rusuage in the
task_struct,</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>406</span></u><span
lang=EN-US> <b><i>&nbsp;* except that would make the task_struct be *really
big*.&nbsp; After</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>407</span></u><span
lang=EN-US> <b><i>&nbsp;* task_struct gets moved into malloc'ed memory, it
would</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>408</span></u><span
lang=EN-US> <b><i>&nbsp;* make sense to do this.&nbsp; It will make moving the
rest of the information</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>409</span></u><span
lang=EN-US> <b><i>&nbsp;* a lot simpler!&nbsp; (Which we're not doing right now
because we're not</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>410</span></u><span
lang=EN-US> <b><i>&nbsp;* measuring them yet).</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>411</span></u><span
lang=EN-US> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /* </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��<span
lang=EN-US>rusuage</span>�ṹ�Ž�����ṹ<span lang=EN-US>task struct</span>����ǡ���ģ���������ʹ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�ṹ���ȱ�÷ǳ����ڰ�����ṹ�����ں�<span
lang=EN-US>malloc</span>������ڴ���֮��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��������ʹ����ṹ�ܴ�Ҳû�����ˡ��⽫ʹ��������Ϣ���ƶ���÷ǳ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>���㣡�����ǻ�û������������Ϊ���ǻ�û�в��Թ����ǵĴ�С����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ȡָ�����̵���Դ������Ϣ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ϵͳ�����ṩ��ǰ���̻�������ֹ�ĺ͵ȴ��ŵ��ӽ�����Դʹ��������������<span
lang=EN-US>who</span>����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // RUSAGE_SELF</span>���򷵻ص�ǰ���̵���Դ������Ϣ�����ָ������<span
lang=EN-US>who </span>��<span lang=EN-US> RUSAGE_CHILDREN</span>��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�򷵻ص�ǰ���̵�����ֹ�͵ȴ��ŵ��ӽ�����Դ������Ϣ��
���ų���<span lang=EN-US>RUSAGE_SELF </span>��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // RUSAGE_CHILDREN </span>�Լ�<span
lang=EN-US> rusage</span>�ṹ��������<span lang=EN-US> include/sys/resource.h</span>ͷ�ļ��С�</p>

<p class=a><u><span lang=EN-US style='color:blue'>412</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_getrusage</span></u>(int who,
struct <u><span style='color:blue'>rusage</span></u> *ru)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>413</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>414</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct <u><span
style='color:blue'>rusage</span></u> r;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>415</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned
long&nbsp;&nbsp; *lp, *lpend, *dest;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>416</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�����жϲ���ָ�����̵���Ч�ԡ����<span
lang=EN-US>who</span>�Ȳ���<span lang=EN-US>RUSAGE_SELF</span>��ָ����ǰ���̣���Ҳ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // RUSAGE_CHILDREN </span>��ָ���ӽ��̣���������Ч�����뷵�ء���������֤��ָ��<span
lang=EN-US>ru </span>ָ������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����������󣬰���ʱ<span
lang=EN-US> rusage</span>�ṹ����<span lang=EN-US>r</span>���㡣</p>

<p class=a><u><span lang=EN-US style='color:blue'>417</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (who != <u><span
style='color:blue'>RUSAGE_SELF</span></u> &amp;&amp; who != <u><span
style='color:blue'>RUSAGE_CHILDREN</span></u>)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>418</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EINVAL</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>419</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>verify_area</span></u>(ru, sizeof *ru);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>420</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>memset</span></u>((char *) &amp;r, 0, sizeof(r));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// </span>��<span lang=EN-US>include/strings.h</span>�ļ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>������<span lang=EN-US>who
</span>��<span lang=EN-US>RUSAGE_SELF</span>�����Ƶ�ǰ������Դ������Ϣ��<span lang=EN-US>r</span>�ṹ�С���ָ������<span
lang=EN-US>who</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��<span lang=EN-US>RUSAGE_CHILDREN</span>��
���Ƶ�ǰ���̵�����ֹ�͵ȴ��ŵ��ӽ�����Դ������Ϣ����ʱ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // rusuage</span>�ṹ<span
lang=EN-US>r</span>�С���<span lang=EN-US>CT_TO_SECS </span>��<span lang=EN-US>CT_TO_USECS</span>���ڰ�ϵͳ��ǰ�����ת��������ֵ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��΢��ֵ��ʾ�����Ƕ�����<span
lang=EN-US> include/linux/sched.h </span>�ļ��С�<span lang=EN-US> jiffies_offset</span>��ϵͳ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���������������</p>

<p class=a><u><span lang=EN-US style='color:blue'>421</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (who == <u><span
style='color:blue'>RUSAGE_SELF</span></u>) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>422</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
r.ru_utime.tv_sec = <u><span style='color:blue'>CT_TO_SECS</span></u>(<u><span
style='color:blue'>current</span></u>-&gt;<u><span style='color:blue'>utime</span></u>);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>423</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
r.ru_utime.tv_usec = <u><span style='color:blue'>CT_TO_USECS</span></u>(<u><span
style='color:blue'>current</span></u>-&gt;<u><span style='color:blue'>utime</span></u>);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>424</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
r.ru_stime.tv_sec = <u><span style='color:blue'>CT_TO_SECS</span></u>(<u><span
style='color:blue'>current</span></u>-&gt;<u><span style='color:blue'>stime</span></u>);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>425</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
r.ru_stime.tv_usec = <u><span style='color:blue'>CT_TO_USECS</span></u>(<u><span
style='color:blue'>current</span></u>-&gt;<u><span style='color:blue'>stime</span></u>);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>426</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>427</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;r.ru_utime.tv_sec = <u><span style='color:blue'>CT_TO_SECS</span></u>(<u><span
style='color:blue'>current</span></u>-&gt;cutime);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>428</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
r.ru_utime.tv_usec = <u><span style='color:blue'>CT_TO_USECS</span></u>(<u><span
style='color:blue'>current</span></u>-&gt;cutime);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>429</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
r.ru_stime.tv_sec = <u><span style='color:blue'>CT_TO_SECS</span></u>(<u><span
style='color:blue'>current</span></u>-&gt;cstime);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>430</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
r.ru_stime.tv_usec = <u><span style='color:blue'>CT_TO_USECS</span></u>(<u><span
style='color:blue'>current</span></u>-&gt;cstime);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>431</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>Ȼ����<span lang=EN-US>lp</span>ָ��ָ��<span
lang=EN-US>r</span>�ṹ��<span lang=EN-US>lpend</span>ָ��<span lang=EN-US>r</span>�ṹĩβ������<span
lang=EN-US>dest</span>ָ��ָ���û��ռ��е�<span lang=EN-US>ru</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�ṹ������<span
lang=EN-US>r</span>����Ϣ���Ƶ��û��ռ�<span lang=EN-US>ru</span>�ṹ�У�������<span lang=EN-US>0</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>432</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lp = (unsigned long
*) &amp;r;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>433</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lpend = (unsigned
long *) (&amp;r+1);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>434</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dest = (unsigned
long *) ru;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>435</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (; lp &lt;
lpend; lp++, dest++) </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>436</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(*lp, dest);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>437</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(0);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>438</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>439</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>ȡ��ϵͳ��ǰʱ�䣬����ָ����ʽ���ء�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // timeval</span>�ṹ��<span
lang=EN-US>timezone</span>�ṹ��������<span lang=EN-US>include/sys/time.h</span>�ļ��С�<span
lang=EN-US>timeval</span>�ṹ������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��΢�루<span lang=EN-US>tv_sec</span>��<span
lang=EN-US>tv_usec</span>�������ֶΡ�<span lang=EN-US>timezone</span>�ṹ���б��ؾ�������α�׼ʱ������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�ķ�������<span lang=EN-US>tz_minuteswest</span>��������ʱ��������ͣ�<span
lang=EN-US>tz_dsttime</span>�������ֶΡ�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��<span lang=EN-US>dst
-- Daylight Savings Time</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>440</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_gettimeofday</span></u>(struct <u><span
style='color:blue'>timeval</span></u> *tv, struct <u><span style='color:blue'>timezone</span></u>
*tz)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>441</span></u><span
lang=EN-US> {</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�������������<span
lang=EN-US>timeval</span>�ṹָ�벻�գ����ڸýṹ�з��ص�ǰʱ�䣨��ֵ��΢��ֵ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��������������û����ݿռ���<span
lang=EN-US> timezone</span>�ṹ��ָ�벻�գ���Ҳ���ظýṹ����Ϣ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>������<span lang=EN-US>startup_time</span>��ϵͳ����ʱ�䣨��ֵ����
��<span lang=EN-US>CT_TO_SECS</span>��<span lang=EN-US>CT_TO_USECS</span>����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ϵͳ��ǰ�����ת��������ֵ��΢��ֵ��ʾ�����Ƕ�����<span
lang=EN-US>include/linux/sched.h</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�ļ��С�<span lang=EN-US>jiffies_offset</span>��ϵͳ���������������</p>

<p class=a><u><span lang=EN-US style='color:blue'>442</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tv) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>443</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>verify_area</span></u>(tv, sizeof *tv);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>444</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>startup_time</span></u>
+ <u><span style='color:blue'>CT_TO_SECS</span></u>(<u><span style='color:blue'>jiffies</span></u>+<u><span
style='color:blue'>jiffies_offset</span></u>),</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>445</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(unsigned long *) tv);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>446</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>CT_TO_USECS</span></u>(<u><span
style='color:blue'>jiffies</span></u>+<u><span style='color:blue'>jiffies_offset</span></u>),
</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>447</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;((unsigned long *) tv)+1);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>448</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>449</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tz) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>450</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>verify_area</span></u>(tz, sizeof *tz);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>451</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>sys_tz</span></u>.tz_minuteswest,
(unsigned long *) tz);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>452</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>put_fs_long</span></u>(<u><span style='color:blue'>sys_tz</span></u>.tz_dsttime,
((unsigned long *) tz)+1);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>453</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>454</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>455</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>456</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>457</span></u><span
lang=EN-US> <b><i>/*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>458</span></u><span
lang=EN-US> <b><i>&nbsp;* The first time we set the timezone, we will warp the
clock so that</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>459</span></u><span
lang=EN-US> <b><i>&nbsp;* it is ticking GMT time instead of local time.&nbsp;
Presumably, </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>460</span></u><span
lang=EN-US> <b><i>&nbsp;* if someone is setting the timezone then we are
running in an</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>461</span></u><span
lang=EN-US> <b><i>&nbsp;* environment where the programs understand about
timezones.</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>462</span></u><span
lang=EN-US> <b><i>&nbsp;* This should be done at boot time in the /etc/rc
script, as</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>463</span></u><span
lang=EN-US> <b><i>&nbsp;* soon as possible, so that the clock can be set
right.&nbsp; Otherwise,</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>464</span></u><span
lang=EN-US> <b><i>&nbsp;* various programs will get confused when the clock
gets warped.</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>465</span></u><span
lang=EN-US> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /* </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�ڵ�<span
lang=EN-US>1</span>������ʱ����<span lang=EN-US>timezone</span>��ʱ�����ǻ�ı�ʱ��ֵ����ϵͳʹ�ø���</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>���α�׼ʱ�䣨<span
lang=EN-US>GMT</span>�����У�����ʹ�ñ���ʱ�䡣 �Ʋ�����˵�����ĳ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>������ʱ��ʱ�䣬��ô���Ǿ������ڳ���֪��ʱ��ʱ��Ļ����С�����ʱ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>������Ӧ����ϵͳ�����׶Σ��������<span
lang=EN-US>/etc/rc</span>�ű������н��С�����ʱ</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�ӾͿ���������ȷ�� ����Ļ����������Ժ������ʱ��������ʱ��ʱ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�ı䣬���ܻ���һЩ��������г������⡣</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ϵͳ��ǰʱ�䡣</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>tv</span>��ָ���û���������<span
lang=EN-US>timeval</span>�ṹ��Ϣ��ָ�롣����<span lang=EN-US>tz</span>���û���������<span
lang=EN-US>timezone</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>�ṹ��ָ�롣�ò�����Ҫ�����û�Ȩ�ޡ�������߽�Ϊ�գ���ʲôҲ��������������<span
lang=EN-US>0</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>466</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_settimeofday</span></u>(struct <u><span
style='color:blue'>timeval</span></u> *tv, struct <u><span style='color:blue'>timezone</span></u>
*tz)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>467</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>468</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static
int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; firsttime = 1;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>469</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
void&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>adjust_clock</span></u>();</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>470</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����ϵͳ��ǰʱ����Ҫ�����û�Ȩ�ޡ����<span
lang=EN-US>tz</span>ָ�벻�գ�������ϵͳʱ����Ϣ���������û�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // timezone</span>�ṹ��Ϣ��ϵͳ�е�<span
lang=EN-US> sys_tz</span>�ṹ�У�����<span lang=EN-US>24</span>�У�������ǵ�<span
lang=EN-US>1</span>�ε��ñ�ϵͳ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���Ҳ���<span lang=EN-US>tv</span>ָ�벻�գ������ϵͳʱ��ֵ��</p>

<p class=a><u><span lang=EN-US style='color:blue'>471</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!<u><span
style='color:blue'>suser</span></u>())</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>472</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return -<u><span style='color:blue'>EPERM</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>473</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tz) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>474</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>sys_tz</span></u>.tz_minuteswest = <u><span
style='color:blue'>get_fs_long</span></u>((unsigned long *) tz);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>475</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>sys_tz</span></u>.tz_dsttime = <u><span
style='color:blue'>get_fs_long</span></u>(((unsigned long *) tz)+1);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>476</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (firsttime) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>477</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
firsttime = 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>478</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (!tv)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>479</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>adjust_clock</span></u>();</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>480</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>481</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���������<span lang=EN-US>timeval</span>�ṹָ��<span
lang=EN-US>tv</span>���գ����øýṹ��Ϣ����ϵͳʱ�ӡ����ȴ�<span lang=EN-US>tv</span>��ָ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ȡ����ֵ��<span
lang=EN-US>sec</span>����΢��ֵ��<span lang=EN-US>usec</span>����ʾ��ϵͳʱ�䣬Ȼ������ֵ�޸�ϵͳ����ʱ��ȫ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>����<span lang=EN-US>startup_time</span>ֵ������΢��ֵ����ϵͳ������ֵ<span
lang=EN-US>jiffies_offset</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>482</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tv) {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>483</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int sec, usec;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>484</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>485</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sec = <u><span style='color:blue'>get_fs_long</span></u>((unsigned long *)tv);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>486</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
usec = <u><span style='color:blue'>get_fs_long</span></u>(((unsigned long *)tv)+1);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>487</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>488</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>startup_time</span></u> = sec - <u><span
style='color:blue'>jiffies</span></u>/<u><span style='color:blue'>HZ</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>489</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<u><span style='color:blue'>jiffies_offset</span></u> = usec * <u><span
style='color:blue'>HZ</span></u> / 1000000 - <u><span style='color:blue'>jiffies</span></u>%<u><span
style='color:blue'>HZ</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>490</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>491</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>492</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>493</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>494</span></u><span
lang=EN-US> <b><i>/*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>495</span></u><span
lang=EN-US> <b><i>&nbsp;* Adjust the time obtained from the CMOS to be GMT time
instead of</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>496</span></u><span
lang=EN-US> <b><i>&nbsp;* local time.</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>497</span></u><span
lang=EN-US> <b><i>&nbsp;* </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>498</span></u><span
lang=EN-US> <b><i>&nbsp;* This is ugly, but preferable to the
alternatives.&nbsp; Otherwise we</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>499</span></u><span
lang=EN-US> <b><i>&nbsp;* would either need to write a program to do it in
/etc/rc (and risk</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>500</span></u><span
lang=EN-US> <b><i>&nbsp;* confusion if the program gets run more than once; it
would also be </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>501</span></u><span
lang=EN-US> <b><i>&nbsp;* hard to make the program warp the clock precisely n
hours)&nbsp; or</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>502</span></u><span
lang=EN-US> <b><i>&nbsp;* compile in the timezone information into the
kernel.&nbsp; Bad, bad....</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>503</span></u><span
lang=EN-US> <b><i>&nbsp;*</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>504</span></u><span
lang=EN-US> <b><i>&nbsp;* XXX Currently does not adjust for daylight savings
time.&nbsp; May not</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>505</span></u><span
lang=EN-US> <b><i>&nbsp;* need to do anything, depending on how smart (dumb?)
the BIOS</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>506</span></u><span
lang=EN-US> <b><i>&nbsp;* is.&nbsp; Blast it all.... the best thing to do not
depend on the CMOS</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>507</span></u><span
lang=EN-US> <b><i>&nbsp;* clock at all, but get the time via NTP or timed if
you're on a </i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>508</span></u><span
lang=EN-US> <b><i>&nbsp;*
network....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
- TYT, 1/1/92</i></b></span></p>

<p class=a><u><span lang=EN-US style='color:blue'>509</span></u><span
lang=EN-US> <b><i>&nbsp;*/</i></b></span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; /*</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�Ѵ�<span
lang=EN-US>CMOS</span>�ж�ȡ��ʱ��ֵ����Ϊ<span lang=EN-US>GMT</span>ʱ��ֵ���棬���Ǳ���ʱ��ֵ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; *</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��������������ţ���Ҫ�����������á��������Ǿ���Ҫдһ����������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>��<span
lang=EN-US>/etc/rc</span>��������������£�����ð�Ÿó�����ܻᱻ���ִ�ж�������</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>���⡣ ����������Ҳ�����ó����ʱ�Ӿ�ȷ�ص���<span
lang=EN-US>n</span>Сʱ�� ���߰�ʱ����</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>Ϣ������ں��С���Ȼ�������ͷǳ����ǳ����<span
lang=EN-US>...</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>Ŀǰ���溯����<span
lang=EN-US>XXX</span>���ĵ���������û�п��ǵ�����ʱ���⡣����<span lang=EN-US>BIOS</span>�ж�</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>ô���ܣ��޴�����Ҳ�������Ͳ��ÿ����ⷽ�档��Ȼ����õ���������ȫ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>������<span
lang=EN-US>CMOS</span>ʱ�ӣ�������ϵͳͨ��<span lang=EN-US>NTP</span>������ʱ��Э�飩����<span
lang=EN-US>timed</span>��ʱ��</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; * </span>�����������ʱ�䣬��������������Ļ�<span
lang=EN-US>...</span>��<span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
- TYT</span>��<span
 lang=EN-US>1/1/92</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp; */</span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>��ϵͳ����ʱ�����Ϊ��<span
lang=EN-US>GMT</span>Ϊ��׼��ʱ�䡣</p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // startup_time</span>����ֵ�����������Ҫ��ʱ������ֵ����<span
lang=EN-US>60</span>��</p>

<p class=a><u><span lang=EN-US style='color:blue'>510</span></u><span
lang=EN-US> void <u><span style='color:blue'>adjust_clock</span></u>()</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>511</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>512</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>startup_time</span></u> += <u><span style='color:blue'>sys_tz</span></u>.tz_minuteswest*60;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>513</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>514</span></u><span
lang=EN-US> </span></p>

<p class=a><span lang=EN-US>&nbsp;&nbsp;&nbsp; // </span>���õ�ǰ���̴����ļ�����������Ϊ<span
lang=EN-US>mask &amp; 0777</span>��������ԭ�����롣</p>

<p class=a><u><span lang=EN-US style='color:blue'>515</span></u><span
lang=EN-US> int <u><span style='color:blue'>sys_umask</span></u>(int mask)</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>516</span></u><span
lang=EN-US> {</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>517</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int old = <u><span
style='color:blue'>current</span></u>-&gt;<u><span style='color:blue'>umask</span></u>;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>518</span></u><span
lang=EN-US> </span></p>

<p class=a><u><span lang=EN-US style='color:blue'>519</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u><span
style='color:blue'>current</span></u>-&gt;<u><span style='color:blue'>umask</span></u>
= mask &amp; 0777;</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>520</span></u><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (old);</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>521</span></u><span
lang=EN-US> }</span></p>

<p class=a><u><span lang=EN-US style='color:blue'>522</span></u><span
lang=EN-US> </span></p>

<div class=a align=center style='text-align:center'><span lang=EN-US>

<hr size=4 width="100%" align=center>

</span></div>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

</div>

</body>

</html>
